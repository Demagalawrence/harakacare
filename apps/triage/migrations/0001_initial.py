# Generated by Django 6.0.2 on 2026-02-20 11:21

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='TriageSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('cancelled', 'Cancelled'), ('failed', 'Failed'), ('archived', 'Archived')], default='draft', max_length=20)),
                ('status_changed_at', models.DateTimeField(auto_now=True)),
                ('status_reason', models.TextField(blank=True, null=True)),
                ('patient_token', models.CharField(db_index=True, help_text='Anonymous identifier for this patient session', max_length=64, unique=True, verbose_name='patient token')),
                ('session_status', models.CharField(choices=[('started', 'Started'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('escalated', 'Escalated'), ('cancelled', 'Cancelled')], default='started', max_length=20, verbose_name='session status')),
                ('complaint_text', models.TextField(blank=True, help_text='Original user message: "Tell me what is happening"', verbose_name='complaint text')),
                ('complaint_group', models.CharField(blank=True, choices=[('fever', 'Fever / feeling hot'), ('breathing', 'Breathing or cough problem'), ('injury', 'Injury or accident'), ('abdominal', 'Abdominal pain / vomiting / diarrhea'), ('headache', 'Headache / confusion / weakness'), ('chest_pain', 'Chest pain'), ('pregnancy', 'Pregnancy concern'), ('skin', 'Skin problem'), ('feeding', 'Feeding problem / general weakness'), ('bleeding', 'Bleeding / blood loss'), ('mental_health', 'Mental health / emotional crisis'), ('other', 'Other')], help_text='AI-classified complaint group (NOT a diagnosis)', max_length=50, null=True, verbose_name='complaint group')),
                ('age_group', models.CharField(choices=[('newborn', 'Newborn (0-2 months)'), ('infant', 'Infant (2-12 months)'), ('child_1_5', 'Child (1-5 years)'), ('child_6_12', 'Child (6-12 years)'), ('teen', 'Teen (13-17 years)'), ('adult', 'Adult (18-64 years)'), ('elderly', 'Elderly (65+ years)')], help_text='Age group - determines question tree and risk modifiers', max_length=20, verbose_name='age group')),
                ('sex', models.CharField(choices=[('male', 'Male'), ('female', 'Female'), ('other', 'Other / Prefer not to say')], help_text='Biological sex - required for pregnancy screening', max_length=20, verbose_name='sex')),
                ('patient_relation', models.CharField(choices=[('self', 'For myself'), ('child', 'For my child'), ('family', 'For family member'), ('other', 'For someone else')], default='self', help_text='Who is the patient?', max_length=20, verbose_name='patient relation')),
                ('symptom_indicators', models.JSONField(blank=True, default=dict, help_text='Structured answers from adaptive questions, e.g., {"breathing_difficulty": true, "chest_indrawing": false, "can_drink": true, "rash_present": false}', verbose_name='symptom indicators')),
                ('symptom_severity', models.CharField(blank=True, choices=[('mild', 'Mild - can do normal activities'), ('moderate', 'Moderate - some difficulty with activities'), ('severe', 'Severe - unable to do normal activities'), ('very_severe', 'Very severe - unable to move/talk/function')], max_length=20, null=True, verbose_name='symptom severity')),
                ('symptom_duration', models.CharField(blank=True, choices=[('less_than_1_hour', 'Less than 1 hour'), ('1_6_hours', '1-6 hours'), ('6_24_hours', '6-24 hours'), ('1_3_days', '1-3 days'), ('4_7_days', '4-7 days'), ('more_than_1_week', 'More than 1 week'), ('more_than_1_month', 'More than 1 month')], max_length=20, null=True, verbose_name='symptom duration')),
                ('progression_status', models.CharField(blank=True, choices=[('sudden', 'Sudden onset'), ('getting_worse', 'Getting worse'), ('staying_same', 'Staying the same'), ('getting_better', 'Getting better'), ('comes_and_goes', 'Comes and goes')], help_text='Observable symptom trajectory', max_length=20, null=True, verbose_name='progression status')),
                ('red_flag_indicators', models.JSONField(blank=True, default=dict, help_text='WHO ABCD danger signs detected at any point: {"airway_obstruction": false, "severe_breathing": true, "heavy_bleeding": false, "unconscious": false, "convulsions": false, "confusion": false}', verbose_name='red flag indicators')),
                ('has_red_flags', models.BooleanField(default=False, help_text='Whether ANY emergency red flags were detected', verbose_name='has red flags')),
                ('red_flag_detected_at_turn', models.IntegerField(blank=True, help_text='Conversation turn number when first red flag detected', null=True, verbose_name='red flag detected at turn')),
                ('risk_modifiers', models.JSONField(blank=True, default=dict, help_text='High-risk population flags: {"is_pregnant": false, "has_chronic_asthma": true, "is_newborn": false, "is_immunocompromised": false}', verbose_name='risk modifiers')),
                ('pregnancy_status', models.CharField(blank=True, choices=[('yes', 'Yes, confirmed pregnant'), ('possible', 'Possibly pregnant'), ('no', 'No'), ('not_applicable', 'Not applicable')], max_length=30, null=True, verbose_name='pregnancy status')),
                ('has_chronic_conditions', models.BooleanField(default=False, help_text='Patient has any chronic illness (details in risk_modifiers)', verbose_name='has chronic conditions')),
                ('on_medication', models.BooleanField(default=False, help_text='Patient is currently taking any medication', verbose_name='on medication')),
                ('district', models.CharField(help_text='District or area', max_length=100, verbose_name='district')),
                ('subcounty', models.CharField(blank=True, help_text='Sub-county or division', max_length=100, null=True, verbose_name='subcounty')),
                ('village', models.CharField(blank=True, help_text='Village or LC1', max_length=100, null=True, verbose_name='village')),
                ('device_location_lat', models.FloatField(blank=True, help_text='Device GPS latitude (consent-based)', null=True, verbose_name='latitude')),
                ('device_location_lng', models.FloatField(blank=True, help_text='Device GPS longitude (consent-based)', null=True, verbose_name='longitude')),
                ('location_consent', models.BooleanField(default=False, help_text='Whether patient consented to share device location', verbose_name='location consent')),
                ('primary_symptom', models.CharField(blank=True, help_text='DEPRECATED: Use complaint_group instead', max_length=50, null=True, verbose_name='primary symptom (DEPRECATED)')),
                ('secondary_symptoms', models.JSONField(blank=True, default=list, help_text='DEPRECATED: Use symptom_indicators instead')),
                ('red_flags', models.JSONField(blank=True, default=list, help_text='DEPRECATED: Use red_flag_indicators instead')),
                ('chronic_conditions', models.JSONField(blank=True, default=list, help_text='DEPRECATED: Use risk_modifiers instead')),
                ('additional_description', models.TextField(blank=True, help_text='DEPRECATED: Use complaint_text instead', verbose_name='additional description (DEPRECATED)')),
                ('consent_medical_triage', models.BooleanField(default=False, verbose_name='consent for medical triage')),
                ('consent_data_sharing', models.BooleanField(default=False, help_text='Consent for anonymized data sharing with health facilities', verbose_name='consent for data sharing')),
                ('consent_follow_up', models.BooleanField(default=False, help_text='Consent for follow-up if required', verbose_name='consent for follow-up')),
                ('risk_level', models.CharField(blank=True, choices=[('low', 'Low Risk'), ('medium', 'Medium Risk'), ('high', 'High Risk')], help_text='Final risk level (after all adjustments)', max_length=20, null=True, verbose_name='risk level')),
                ('risk_confidence', models.FloatField(blank=True, help_text='AI model confidence score (0-1)', null=True, validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)], verbose_name='risk confidence')),
                ('follow_up_priority', models.CharField(blank=True, choices=[('routine', 'Routine'), ('urgent', 'Urgent'), ('immediate', 'Immediate')], max_length=20, null=True, verbose_name='follow-up priority')),
                ('ai_model_version', models.CharField(blank=True, help_text='Version of AI model used for assessment', max_length=50, null=True, verbose_name='AI model version')),
                ('assessment_completed_at', models.DateTimeField(blank=True, null=True, verbose_name='assessment completed at')),
                ('forwarded_to_followup', models.BooleanField(default=False, verbose_name='forwarded to follow-up agent')),
                ('forwarded_to_facility', models.BooleanField(default=False, verbose_name='forwarded to facility matching')),
                ('channel', models.CharField(choices=[('ussd', 'USSD'), ('sms', 'SMS'), ('whatsapp', 'WhatsApp'), ('web', 'Web'), ('mobile_app', 'Mobile App')], default='ussd', max_length=20, verbose_name='channel')),
                ('conversation_turns', models.IntegerField(default=0, help_text='Number of conversation turns to complete triage', verbose_name='conversation turns')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'triage session',
                'verbose_name_plural': 'triage sessions',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='TriageDecision',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('final_risk_level', models.CharField(choices=[('low', 'Low Risk'), ('medium', 'Medium Risk'), ('high', 'High Risk')], help_text='Final triage risk level', max_length=20, verbose_name='final risk level')),
                ('follow_up_priority', models.CharField(choices=[('routine', 'Routine'), ('urgent', 'Urgent'), ('immediate', 'Immediate')], help_text='Priority for follow-up', max_length=20, verbose_name='follow-up priority')),
                ('decision_basis', models.CharField(choices=[('red_flag_override', 'Red Flag Override'), ('age_risk_modifier', 'Age/Risk Modifier'), ('ai_primary', 'AI Primary'), ('clinical_adjustment', 'Clinical Adjustment'), ('conservative_bias', 'Conservative Bias')], help_text='Primary basis for final decision', max_length=50, verbose_name='decision basis')),
                ('recommended_action', models.TextField(help_text='Recommended next steps for patient', verbose_name='recommended action')),
                ('facility_type_recommendation', models.CharField(blank=True, choices=[('emergency', 'Emergency Department - IMMEDIATE'), ('hospital', 'Hospital - Urgent'), ('health_center', 'Health Center - Soon'), ('clinic', 'Clinic - Routine'), ('self_care', 'Self-care with monitoring')], max_length=50, null=True, verbose_name='facility type recommendation')),
                ('decision_timestamp', models.DateTimeField(auto_now_add=True, verbose_name='decision timestamp')),
                ('decision_reasoning', models.TextField(help_text='Detailed explanation of how decision was reached (audit trail)', verbose_name='decision reasoning')),
                ('disclaimers', models.JSONField(default=list, help_text='Disclaimers shown to patient')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('triage_session', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='triage_decision', to='triage.triagesession', verbose_name='triage session')),
            ],
            options={
                'verbose_name': 'triage decision',
                'verbose_name_plural': 'triage decisions',
            },
        ),
        migrations.CreateModel(
            name='SymptomAssessment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('symptom_complexity_score', models.FloatField(default=0.0, validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(10.0)], verbose_name='symptom complexity score')),
                ('symptom_cluster', models.CharField(blank=True, max_length=100, verbose_name='symptom cluster')),
                ('differential_conditions', models.JSONField(blank=True, default=list)),
                ('assessment_notes', models.TextField(blank=True, verbose_name='assessment notes')),
                ('pain_scale', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(10)], verbose_name='pain scale')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('triage_session', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='symptom_assessment', to='triage.triagesession', verbose_name='triage session')),
            ],
            options={
                'verbose_name': 'symptom assessment (DEPRECATED)',
                'verbose_name_plural': 'symptom assessments (DEPRECATED)',
            },
        ),
        migrations.CreateModel(
            name='RiskClassification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('raw_risk_score', models.FloatField(help_text='Raw AI model risk score (0-1)', validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)], verbose_name='raw risk score')),
                ('ai_risk_level', models.CharField(choices=[('low', 'Low Risk'), ('medium', 'Medium Risk'), ('high', 'High Risk')], help_text='AI-determined risk level before adjustments', max_length=20, verbose_name='AI risk level')),
                ('confidence_score', models.FloatField(help_text='Model confidence in prediction', validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)], verbose_name='confidence score')),
                ('model_name', models.CharField(help_text='Name of AI model used', max_length=100, verbose_name='model name')),
                ('model_version', models.CharField(help_text='Version of model used', max_length=50, verbose_name='model version')),
                ('inference_time_ms', models.IntegerField(blank=True, help_text='Time taken for inference in milliseconds', null=True, verbose_name='inference time (ms)')),
                ('feature_importance', models.JSONField(blank=True, help_text='Features that contributed to classification including complaint_group, age_group', null=True, verbose_name='feature importance')),
                ('complaint_embedding', models.JSONField(blank=True, help_text='Complaint text embeddings (for analysis)', null=True, verbose_name='complaint embedding')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('triage_session', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='risk_classification', to='triage.triagesession', verbose_name='triage session')),
            ],
            options={
                'verbose_name': 'risk classification',
                'verbose_name_plural': 'risk classifications',
            },
        ),
        migrations.CreateModel(
            name='RedFlagDetection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('airway_obstruction', models.BooleanField(default=False, help_text='Choking, stridor, cannot speak', verbose_name='airway obstruction')),
                ('severe_breathing_difficulty', models.BooleanField(default=False, help_text='Struggling to breathe, very fast breathing, blue lips', verbose_name='severe breathing difficulty')),
                ('chest_indrawing', models.BooleanField(default=False, help_text='Visible chest pulling in with breathing', verbose_name='chest indrawing (children)')),
                ('severe_bleeding', models.BooleanField(default=False, help_text='Heavy bleeding, blood loss', verbose_name='severe bleeding')),
                ('signs_of_shock', models.BooleanField(default=False, help_text='Very pale/weak, collapse, cold extremities', verbose_name='signs of shock')),
                ('unconscious', models.BooleanField(default=False, help_text='Not responding, cannot be woken', verbose_name='unconscious / unresponsive')),
                ('convulsions', models.BooleanField(default=False, help_text='Fitting, convulsing now or recently', verbose_name='convulsions/seizures')),
                ('confusion', models.BooleanField(default=False, help_text='Cannot recognize people, confused speech', verbose_name='confusion / disorientation')),
                ('stroke_symptoms', models.BooleanField(default=False, help_text='Face droop, arm weakness, speech difficulty, sudden onset', verbose_name='stroke symptoms')),
                ('unable_to_drink', models.BooleanField(default=False, help_text='Cannot drink or breastfeed', verbose_name='unable to drink/feed (child)')),
                ('vomits_everything', models.BooleanField(default=False, help_text='Vomits everything given', verbose_name='vomits everything (child)')),
                ('lethargic_floppy', models.BooleanField(default=False, help_text='Baby unusually sleepy, floppy, difficult to wake', verbose_name='lethargic/floppy (infant)')),
                ('severe_pain', models.BooleanField(default=False, help_text='Worst pain ever experienced, unbearable', verbose_name='severe uncontrolled pain')),
                ('pregnancy_emergency', models.BooleanField(default=False, help_text='Heavy vaginal bleeding, severe abdominal pain in pregnancy', verbose_name='pregnancy emergency')),
                ('emergency_override', models.BooleanField(default=False, help_text='Red flags override AI assessment', verbose_name='emergency override')),
                ('detection_method', models.CharField(choices=[('user_keywords', 'User Keywords'), ('ai_detected', 'AI Detected'), ('adaptive_question', 'Adaptive Question Response'), ('continuous_monitoring', 'Continuous Monitoring')], default='user_keywords', max_length=50, verbose_name='detection method')),
                ('detected_flags_count', models.IntegerField(default=0, help_text='Number of red flags detected', verbose_name='detected flags count')),
                ('detection_turn_number', models.IntegerField(blank=True, help_text='Conversation turn when flags were detected', null=True, verbose_name='detection turn number')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('triage_session', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='red_flag_detection', to='triage.triagesession', verbose_name='triage session')),
            ],
            options={
                'verbose_name': 'red flag detection',
                'verbose_name_plural': 'red flag detections',
            },
        ),
        migrations.CreateModel(
            name='ClinicalContext',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('age_modifier', models.FloatField(default=0.0, help_text='Risk adjustment for age: newborn/infant +0.2, elderly +0.15, child_1_5 +0.1', verbose_name='age modifier')),
                ('pregnancy_modifier', models.FloatField(default=0.0, help_text='Risk adjustment for pregnancy', verbose_name='pregnancy modifier')),
                ('chronic_condition_modifier', models.FloatField(default=0.0, help_text='Risk adjustment for chronic conditions', verbose_name='chronic condition modifier')),
                ('immunocompromised_modifier', models.FloatField(default=0.0, help_text='Risk adjustment for immunocompromised status', verbose_name='immunocompromised modifier')),
                ('medication_modifier', models.FloatField(default=0.0, help_text='Risk adjustment for current medications', verbose_name='medication modifier')),
                ('total_risk_adjustment', models.FloatField(default=0.0, help_text='Combined risk adjustment factor', verbose_name='total risk adjustment')),
                ('adjustment_reasoning', models.TextField(blank=True, help_text='Explanation for risk adjustments made', verbose_name='adjustment reasoning')),
                ('adjusted_risk_level', models.CharField(choices=[('low', 'Low Risk'), ('medium', 'Medium Risk'), ('high', 'High Risk')], help_text='Risk level after clinical context adjustments', max_length=20, verbose_name='adjusted risk level')),
                ('conservative_bias_applied', models.BooleanField(default=False, help_text='Whether conservative bias was applied (never downgrade)', verbose_name='conservative bias applied')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('triage_session', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='clinical_context', to='triage.triagesession', verbose_name='triage session')),
            ],
            options={
                'verbose_name': 'clinical context',
                'verbose_name_plural': 'clinical contexts',
            },
        ),
        migrations.CreateModel(
            name='AgentCommunicationLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('target_agent', models.CharField(choices=[('follow_up', 'Follow-up Agent'), ('facility_matching', 'Facility Matching Agent'), ('notification', 'Notification Agent')], max_length=50, verbose_name='target agent')),
                ('payload', models.JSONField(help_text='JSON payload sent to target agent', verbose_name='payload')),
                ('communication_status', models.CharField(choices=[('pending', 'Pending'), ('sent', 'Sent'), ('acknowledged', 'Acknowledged'), ('failed', 'Failed')], default='pending', max_length=20, verbose_name='status')),
                ('response_data', models.JSONField(blank=True, help_text='Response received from target agent', null=True, verbose_name='response data')),
                ('sent_at', models.DateTimeField(blank=True, null=True, verbose_name='sent at')),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True, verbose_name='acknowledged at')),
                ('error_message', models.TextField(blank=True, help_text='Error message if communication failed', verbose_name='error message')),
                ('retry_count', models.IntegerField(default=0, help_text='Number of retry attempts', verbose_name='retry count')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('triage_session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='agent_communications', to='triage.triagesession', verbose_name='triage session')),
            ],
            options={
                'verbose_name': 'agent communication log',
                'verbose_name_plural': 'agent communication logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='triagesession',
            index=models.Index(fields=['patient_token'], name='triage_tria_patient_b82edb_idx'),
        ),
        migrations.AddIndex(
            model_name='triagesession',
            index=models.Index(fields=['risk_level', 'created_at'], name='triage_tria_risk_le_f39dbf_idx'),
        ),
        migrations.AddIndex(
            model_name='triagesession',
            index=models.Index(fields=['district', 'subcounty'], name='triage_tria_distric_289588_idx'),
        ),
        migrations.AddIndex(
            model_name='triagesession',
            index=models.Index(fields=['has_red_flags'], name='triage_tria_has_red_456dc0_idx'),
        ),
        migrations.AddIndex(
            model_name='triagesession',
            index=models.Index(fields=['session_status'], name='triage_tria_session_1b2fda_idx'),
        ),
        migrations.AddIndex(
            model_name='triagesession',
            index=models.Index(fields=['age_group', 'complaint_group'], name='triage_tria_age_gro_e999c8_idx'),
        ),
        migrations.AddIndex(
            model_name='triagesession',
            index=models.Index(fields=['complaint_group', 'risk_level'], name='triage_tria_complai_677965_idx'),
        ),
        migrations.AddIndex(
            model_name='agentcommunicationlog',
            index=models.Index(fields=['triage_session', 'target_agent'], name='triage_agen_triage__e0d146_idx'),
        ),
        migrations.AddIndex(
            model_name='agentcommunicationlog',
            index=models.Index(fields=['communication_status'], name='triage_agen_communi_76dfd7_idx'),
        ),
    ]
